- name: Delete `C:\EmployeeInvitation` if it exists on Windows EC2
  run: |
    INSTANCE_ID="i-01a305a3211234"  # Replace with your EC2 instance ID

    echo "Checking and deleting 'C:\EmployeeInvitation' on EC2 instance if it exists..."

    aws ssm send-command \
      --instance-ids "$INSTANCE_ID" \
      --document-name "AWS-RunPowerShellScript" \
      --comment "Delete EmployeeInvitation directory if it exists" \
      --parameters commands='[
        "if (Test-Path \"C:\\EmployeeInvitation\") { 
          Write-Host \"Directory exists. Deleting...\";
          Remove-Item -Path \"C:\\EmployeeInvitation\" -Recurse -Force;
          Write-Host \"Directory Deleted.\";
        } else { 
          Write-Host \"Directory not found. Nothing to delete.\";
        }"
      ]' \
      --timeout-seconds 600 \
      --max-concurrency "50" \
      --max-errors "0" \
      --region us-west-2  # Change this to your AWS region
